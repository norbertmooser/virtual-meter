#!/bin/bash

# Extract the directory name and store it in a variable
# Extract the service name from the script name (remove "backup_" prefix)
SERVICE_NAME="virtual_meter_server"

# Check if service directory exists
if [ ! -d "$SERVICE_NAME" ]; then
    echo "Error: Directory '$SERVICE_NAME' not found"
    exit 1
fi

# Create timestamp in required format
TIMESTAMP=$(date +"%y%m%d_%H%M")
# Create backup filename
BACKUP_FILE="${TIMESTAMP}_${SERVICE_NAME}.tar.gz"

echo $BACKUP_FILE
# Check if backup directory exists, if not create it
BACKUP_DIR=backup
if [ ! -d "$BACKUP_DIR" ]; then
    mkdir "$BACKUP_DIR"
    echo "Created backup directory: $BACKUP_DIR"
fi

# Create tar.gz archive
tar -czf "$BACKUP_FILE" $SERVICE_NAME
# Move archive to backup directory
mv "$BACKUP_FILE" "$BACKUP_DIR/"
echo "Backup created: $BACKUP_DIR/$BACKUP_FILE"

exit 0


